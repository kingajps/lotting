<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Finances | Auction Warehouse</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="finances.css" />
  <script>
    if (sessionStorage.getItem("aw_logged_in") !== "1") {
      window.location.href = "../login.html";
    }
  </script>
</head>
<body>
  <!-- Header -->
  <header class="app-header">
    <div class="header-content">
      <div class="logo-row">
        <span class="logo-icon">
          <svg width="36" height="36" fill="none" viewBox="0 0 36 36">
            <rect width="36" height="36" rx="12" fill="#2563eb"/>
            <path d="M18 10l8 4.5v7c0 .83-.47 1.59-1.19 1.92l-6.81 3.08-6.81-3.08A2.08 2.08 0 0 1 10 21.5v-7L18 10Z" fill="#fff"/>
            <path d="M18 10v13.5" stroke="#2563eb" stroke-width="2"/>
          </svg>
        </span>
        <div>
          <h1 class="header-title">Auction Warehouse</h1>
          <span class="app-subtitle">Management System</span>
        </div>
      </div>
    </div>
  </header>

  <!-- Main nav -->
  <nav class="nav-tabs" aria-label="Main navigation">
    <a class="tab-btn" href="/lotting/index.html">Dashboard</a>
    <a class="tab-btn" href="/lotting/scan/scan.html">Barcode Scanner</a>
    <a class="tab-btn" href="/lotting/inventory/inventory.html">Inventory</a>
    <a class="tab-btn" href="/lotting/storage/storage.html">Storage Map</a>
    <a class="tab-btn" href="/lotting/cases/cases.html">Cases</a>
    <a class="tab-btn" href="/lotting/lots/lots.html">Lots</a>
    <a class="tab-btn active" href="/lotting/finances/finances.html">Finances</a>
    <a class="tab-btn" href="/lotting/analytics/analytics.html">Analytics</a>
  </nav>

  <main class="main-container">
    <nav class="breadcrumb">
      <span>Auction Warehouse</span> / <span>Finances</span>
    </nav>

    <!-- Finance sub-tabs -->
    <div class="finance-tabs" role="tablist" aria-label="Finances sub navigation">
      <button class="finance-tab-btn active" role="tab" aria-selected="true" data-tab="invoices">Invoices</button>
      <button class="finance-tab-btn" role="tab" aria-selected="false" data-tab="settlements">Settlements</button>
      <button class="finance-tab-btn" role="tab" aria-selected="false" data-tab="shipping">Shipping</button>
      <button class="finance-tab-btn" role="tab" aria-selected="false" data-tab="invoice-payments">Invoice Payments</button>
      <button class="finance-tab-btn" role="tab" aria-selected="false" data-tab="settlement-payments">Settlement Payments</button>
    </div>

    <!-- Invoices -->
    <section id="tab-invoices" class="finance-tab-section active" tabindex="0">
      <div class="stats-row">
        <div class="stat-card">
          <div class="stat-title">Total Amount</div>
          <div class="stat-value" id="inv-stat-total">£0.00</div>
        </div>
        <div class="stat-card">
          <div class="stat-title">Total Paid Amount</div>
          <div class="stat-value" id="inv-stat-paid">£0.00</div>
        </div>
        <div class="stat-card danger">
          <div class="stat-title">Total Outstanding Amount</div>
          <div class="stat-value" id="inv-stat-outstanding">£0.00</div>
        </div>
      </div>

      <div class="toolbar">
        <div class="left">
          <div class="dropdown">
            <button class="btn" id="inv-actions-btn">Actions ▾</button>
            <div class="menu" id="inv-actions-menu" hidden>
              <button data-action="export">Export CSV</button>
              <button data-action="reset">Reset Filters</button>
            </div>
          </div>
          <span class="selected-info" id="inv-selected-info">Selected 0</span>
        </div>
        <div class="right">
          <button class="btn icon" id="inv-download" title="Download"><span>⬇️</span></button>
          <button class="btn light" id="inv-reset">Reset</button>
          <button class="btn primary" id="inv-search">Search</button>
        </div>
      </div>

      <div class="filters" id="inv-filters">
        <input class="fi" id="inv-f-invoice" placeholder="Invoice" />
        <select class="fi" id="inv-f-status">
          <option value="">Status</option>
          <option>Paid</option><option>Unpaid</option><option>Cancelled</option><option>Credited</option><option>N/A</option>
        </select>
        <input class="fi" id="inv-f-date-from" type="date" aria-label="Date from" />
        <input class="fi" id="inv-f-date-to" type="date" aria-label="Date to" />
        <input class="fi" id="inv-f-customer" placeholder="Customer" />
        <input class="fi" id="inv-f-sale" placeholder="Sale" />
        <input class="fi small" id="inv-f-min" type="number" placeholder="£ Min Amount" />
        <input class="fi small" id="inv-f-max" type="number" placeholder="£ Max Amount" />
        <input class="fi" id="inv-f-lot" placeholder="Lot Number" />
        <input class="fi" id="inv-f-ref" placeholder="Tracking Code" />
        <label class="fi checkbox"><input id="inv-f-overdue" type="checkbox" /> Overdue</label>
        <label class="fi checkbox"><input id="inv-f-partial" type="checkbox" /> Partially Paid</label>
      </div>

      <div class="finance-card">
        <div class="finance-results-count" id="invoices-results-count"></div>
        <div class="table-scroll">
          <table class="finance-table" id="invoices-table">
            <thead>
              <tr>
                <th class="sel"><input type="checkbox" id="inv-select-all" /></th>
                <th data-sort="invoiceNo">Invoice</th>
                <th data-sort="type">Type</th>
                <th data-sort="sale">Sale</th>
                <th data-sort="buyer">Buyer</th>
                <th data-sort="buyerVat">Total Cost</th>
                <th data-sort="totals">Total / Paid / Outstanding</th>
                <th data-sort="items">Items</th>
                <th data-sort="status">Status</th>
                <th data-sort="raised">Raised</th>
                <th data-sort="shipping">Shipping</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="invoices-tbody"></tbody>
          </table>
        </div>
        <div class="finance-empty" id="invoices-empty" style="display:none;">No invoices found.</div>
        <div class="pager">
          <span id="inv-pager-info"></span>
          <label>Rows per page:
            <select id="inv-rows">
              <option>10</option><option>25</option><option selected>50</option><option>100</option>
            </select>
          </label>
        </div>
      </div>
    </section>

    <!-- Settlements -->
    <section id="tab-settlements" class="finance-tab-section" tabindex="0">
      <div class="stats-row">
        <div class="stat-card">
          <div class="stat-title">Total Amount</div>
          <div class="stat-value" id="set-stat-total">£0.00</div>
        </div>
        <div class="stat-card">
          <div class="stat-title">Total Paid Amount</div>
          <div class="stat-value" id="set-stat-paid">£0.00</div>
        </div>
        <div class="stat-card danger">
          <div class="stat-title">Total Outstanding Amount</div>
          <div class="stat-value" id="set-stat-outstanding">£0.00</div>
        </div>
      </div>

      <div class="toolbar">
        <div class="left">
          <div class="dropdown">
            <button class="btn" id="set-actions-btn">Actions ▾</button>
            <div class="menu" id="set-actions-menu" hidden>
              <button data-action="export">Export CSV</button>
              <button data-action="reset">Reset Filters</button>
            </div>
          </div>
          <span class="selected-info" id="set-selected-info">Selected 0</span>
        </div>
        <div class="right">
          <button class="btn light" id="set-reset">Reset</button>
          <button class="btn primary" id="set-search">Search</button>
        </div>
      </div>

      <div class="filters" id="set-filters">
        <input class="fi" id="set-f-no" placeholder="No." />
        <input class="fi" id="set-f-sale" placeholder="Sale" />
        <input class="fi" id="set-f-company" placeholder="Company Name" />
        <input class="fi" id="set-f-date-from" type="date" />
        <input class="fi" id="set-f-date-to" type="date" />
        <input class="fi" id="set-f-customer" placeholder="Customer" />
        <select class="fi" id="set-f-status">
          <option value="">Status</option><option>Paid</option><option>Unpaid</option><option>Cancelled</option>
        </select>
      </div>

      <div class="finance-card">
        <div class="finance-results-count" id="settlements-results-count"></div>
        <div class="table-scroll">
          <table class="finance-table" id="settlements-table">
            <thead>
              <tr>
                <th class="sel"><input type="checkbox" id="set-select-all" /></th>
                <th data-sort="no">No.</th>
                <th data-sort="type">Type</th>
                <th data-sort="sale">Sale</th>
                <th data-sort="Client">Client</th>
                <th data-sort="ClientVat">Client VAT</th>
                <th data-sort="totals">Total / Paid / Outstanding</th>
                <th data-sort="items">Items</th>
                <th data-sort="status">Status</th>
                <th data-sort="raised">Raised</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="settlements-tbody"></tbody>
          </table>
        </div>
        <div class="finance-empty" id="settlements-empty" style="display:none;">No settlements found.</div>
        <div class="pager">
          <span id="set-pager-info"></span>
          <label>Rows per page:
            <select id="set-rows"><option>10</option><option>25</option><option selected>50</option><option>100</option></select>
          </label>
        </div>
      </div>
    </section>

    <!-- Shipping -->
    <section id="tab-shipping" class="finance-tab-section" tabindex="0">
      <div class="toolbar">
        <div class="left">
          <button class="btn success" id="ship-mark">Mark as Dispatched</button>
          <button class="btn" id="ship-unmark">Unmark as Dispatched</button>
          <span class="selected-info" id="ship-selected-info">Selected 0</span>
        </div>
        <div class="right">
          <button class="btn light" id="ship-reset">Reset</button>
          <button class="btn primary" id="ship-search">Search</button>
        </div>
      </div>

      <div class="filters" id="ship-filters">
        <input class="fi" id="ship-f-invoice" placeholder="Invoice" />
        <select class="fi" id="ship-f-status">
          <option value="">Status</option><option>Paid</option><option>Unpaid</option>
        </select>
        <input class="fi" id="ship-f-date-from" type="date" />
        <input class="fi" id="ship-f-date-to" type="date" />
        <input class="fi" id="ship-f-customer" placeholder="Customer" />
        <input class="fi" id="ship-f-sale" placeholder="Sale" />
        <select class="fi" id="ship-f-shipstatus">
          <option value="">Shipping Status</option><option>Paid</option><option>Credited</option><option>N/A</option><option>Unpaid</option>
        </select>
      </div>

      <div class="finance-card">
        <div class="finance-results-count" id="shipping-results-count"></div>
        <div class="table-scroll">
          <table class="finance-table" id="shipping-table">
            <thead>
              <tr>
                <th class="sel"><input type="checkbox" id="ship-select-all" /></th>
                <th data-sort="invoice">Invoice</th>
                <th data-sort="type">Type</th>
                <th data-sort="sale">Sale</th>
                <th data-sort="buyer">Buyer</th>
                <th data-sort="buyerVat">Total Cost</th>
                <th data-sort="items">Items</th>
                <th data-sort="status">Status</th>
                <th data-sort="raised">Raised</th>
                <th data-sort="shipping">Shipping</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="shipping-tbody"></tbody>
          </table>
        </div>
        <div class="finance-empty" id="shipping-empty" style="display:none;">No shipping records.</div>
        <div class="pager">
          <span id="ship-pager-info"></span>
          <label>Rows per page:
            <select id="ship-rows"><option>10</option><option>25</option><option selected>50</option><option>100</option></select>
          </label>
        </div>
      </div>
    </section>

    <!-- Invoice Payments -->
    <section id="tab-invoice-payments" class="finance-tab-section" tabindex="0">
      <div class="stats-row">
        <div class="stat-card">
          <div class="stat-title">Total Amount</div>
          <div class="stat-value" id="invpay-stat-total">£0.00</div>
        </div>
      </div>

      <div class="toolbar">
        <div class="left">
          <div class="dropdown">
            <button class="btn" id="invpay-actions-btn">Actions ▾</button>
            <div class="menu" id="invpay-actions-menu" hidden>
              <button data-action="export">Export CSV</button>
              <button data-action="reset">Reset Filters</button>
            </div>
          </div>
          <span class="selected-info" id="invpay-selected-info">Selected 0</span>
        </div>
        <div class="right">
          <button class="btn light" id="invpay-reset">Reset</button>
          <button class="btn primary" id="invpay-search">Search</button>
        </div>
      </div>

      <div class="filters" id="invpay-filters">
        <input class="fi" id="invpay-f-invoice" placeholder="Invoice" />
        <input class="fi" id="invpay-f-customer" placeholder="Customer" />
        <input class="fi small" id="invpay-f-min" type="number" placeholder="£ Min Amount" />
        <input class="fi small" id="invpay-f-max" type="number" placeholder="£ Max Amount" />
        <input class="fi" id="invpay-f-batch" placeholder="Batch ID" />
        <input class="fi" id="invpay-f-date-from" type="date" />
        <input class="fi" id="invpay-f-date-to" type="date" />
        <select class="fi" id="invpay-f-method">
          <option value="">Method</option><option>Cash</option><option>Bank transfer</option><option>Card</option><option>Auto</option><option>Overpayment</option><option>Refund</option><option>Deposit</option>
        </select>
        <select class="fi" id="invpay-f-type">
          <option value="">Type</option><option>Payment</option><option>Refund</option>
        </select>
        <label class="fi checkbox"><input id="invpay-f-reconciled" type="checkbox" /> Reconciled</label>
      </div>

      <div class="finance-card">
        <div class="finance-results-count" id="invpay-results-count"></div>
        <div class="table-scroll">
          <table class="finance-table" id="invpay-table">
            <thead>
              <tr>
                <th class="sel"><input type="checkbox" id="invpay-select-all" /></th>
                <th data-sort="invoice">Invoice</th>
                <th data-sort="invoiceType">Invoice Type</th>
                <th data-sort="sale">Sale</th>
                <th data-sort="buyer">Buyer</th>
                <th data-sort="buyerNo">Buyer No</th>
                <th data-sort="paymentType">Payment Type</th>
                <th data-sort="amount">Amount</th>
                <th data-sort="method">Method</th>
                <th data-sort="date">Date</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="invpay-tbody"></tbody>
          </table>
        </div>
        <div class="finance-empty" id="invpay-empty" style="display:none;">No payments found.</div>
        <div class="pager">
          <span id="invpay-pager-info"></span>
          <label>Rows per page:
            <select id="invpay-rows"><option>10</option><option>25</option><option selected>50</option><option>100</option></select>
          </label>
        </div>
      </div>
    </section>

    <!-- Settlement Payments -->
    <section id="tab-settlement-payments" class="finance-tab-section" tabindex="0">
      <div class="stats-row">
        <div class="stat-card">
          <div class="stat-title">Total Amount</div>
          <div class="stat-value" id="setlpay-stat-total">£0.00</div>
        </div>
      </div>

      <div class="toolbar">
        <div class="left">
          <div class="dropdown">
            <button class="btn" id="setlpay-actions-btn">Actions ▾</button>
            <div class="menu" id="setlpay-actions-menu" hidden>
              <button data-action="export">Export CSV</button>
              <button data-action="reset">Reset Filters</button>
            </div>
          </div>
          <span class="selected-info" id="setlpay-selected-info">Selected 0</span>
        </div>
        <div class="right">
          <button class="btn light" id="setlpay-reset">Reset</button>
          <button class="btn primary" id="setlpay-search">Search</button>
        </div>
      </div>

      <div class="filters" id="setlpay-filters">
        <input class="fi" id="setlpay-f-settlement" placeholder="Settlement" />
        <input class="fi" id="setlpay-f-customer" placeholder="Customer" />
        <input class="fi small" id="setlpay-f-min" type="number" placeholder="£ Min Amount" />
        <input class="fi small" id="setlpay-f-max" type="number" placeholder="£ Max Amount" />
        <input class="fi" id="setlpay-f-batch" placeholder="Batch ID" />
        <input class="fi" id="setlpay-f-date-from" type="date" />
        <input class="fi" id="setlpay-f-date-to" type="date" />
        <select class="fi" id="setlpay-f-method">
          <option value="">Method</option><option>Deposit</option><option>Bank transfer</option><option>Cheque</option><option>Other</option>
        </select>
        <label class="fi checkbox"><input id="setlpay-f-reconciled" type="checkbox" /> Reconciled</label>
      </div>

      <div class="finance-card">
        <div class="finance-results-count" id="setlpay-results-count"></div>
        <div class="table-scroll">
          <table class="finance-table" id="setlpay-table">
            <thead>
              <tr>
                <th class="sel"><input type="checkbox" id="setlpay-select-all" /></th>
                <th data-sort="settlement">Settlement</th>
                <th data-sort="settlementType">Settlement Type</th>
                <th data-sort="sale">Sale</th>
                <th data-sort="Client">Client</th>
                <th data-sort="ClientNo">Client No</th>
                <th data-sort="paymentType">Payment Type</th>
                <th data-sort="amount">Amount</th>
                <th data-sort="method">Method</th>
                <th data-sort="date">Date</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="setlpay-tbody"></tbody>
          </table>
        </div>
        <div class="finance-empty" id="setlpay-empty" style="display:none;">No settlement payments.</div>
        <div class="pager">
          <span id="setlpay-pager-info"></span>
          <label>Rows per page:
            <select id="setlpay-rows"><option>10</option><option>25</option><option selected>50</option><option>100</option></select>
          </label>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="dashboard-footer">
    <div class="footer-row">
      <div class="footer-col">
        <div class="footer-logo">
          <svg width="32" height="32" fill="none" viewBox="0 0 36 36">
            <rect width="36" height="36" rx="12" fill="#2563eb"/>
            <path d="M18 10l8 4.5v7c0 .83-.47 1.59-1.19 1.92l-6.81 3.08-6.81-3.08A2.08 2.08 0 0 1 10 21.5v-7L18 10Z" fill="#fff"/>
            <path d="M18 10v13.5" stroke="#2563eb" stroke-width="2"/>
          </svg>
        </div>
        <div class="footer-title">Auction Warehouse System</div>
        <div class="footer-desc">Complete inventory management solution</div>
        <div class="footer-meta">© 2025 JPS Surveyors Auction Warehouse</div>
      </div>
      <div class="footer-col">
        <div class="footer-heading">Features</div>
        <ul class="footer-list">
          <li>Barcode Scanning</li>
          <li>Inventory Management</li>
          <li>Storage Mapping</li>
          <li>Case Tracking</li>
          <li>Lot Management</li>
          <li>Analytics Dashboard</li>
        </ul>
      </div>
      <div class="footer-col">
        <div class="footer-heading">Core Functions</div>
        <ul class="footer-list">
          <li>Item cataloguing</li>
          <li>Warehouse organization</li>
          <li>Client case management</li>
          <li>Performance analytics</li>
          <li>Mobile-friendly interface</li>
          <li>Real-time updates</li>
          <li>Comprehensive reporting</li>
        </ul>
      </div>
    </div>
  </footer>

  <!-- Optional: jsPDF if you also want View/Download from here -->
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf-autotable@3.8.2/dist/jspdf.plugin.autotable.min.js"></script>

  <script src="finances.js"></script>
</body>
</html>
